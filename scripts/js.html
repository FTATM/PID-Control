<!-- JavaScript -->
<script>
    const colors = [
        '#f97316', '#14b8a6', '#f59e0b', '#3b82f6', '#8b5cf6',
        '#ec4899', '#22c55e', '#ef4444', '#06b6d4', '#eab308',
        '#6366f1', '#10b981', '#f43f5e', '#0ea5e9', '#a855f7',
        '#84cc16', '#f97316', '#64748b', '#d946ef', '#0284c7',
        '#16a34a', '#dc2626', '#9333ea', '#0891b2', '#ca8a04'
    ];

    const thaiMonths = ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน', 'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'];

    const screenWidth = window.innerWidth;
    const screenHeight = window.innerHeight;
    let fontSize = 10;

    document.addEventListener('DOMContentLoaded', async () => {
    })

    //=============== Basic Function ==================
    function clamp(n, min, max) {
        return Math.max(min, Math.min(max, n));
    }

    function toNumber(v) {
        const n = parseFloat(v);
        return Number.isFinite(n) ? n : 0;
    }

    function formatNumber(num) {
        return new Intl.NumberFormat('en-US').format(num);
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function Min(list) {
        if (!Array.isArray(list)) return 0;
        let min = Math.min(list);
        return min;
    }

    function Max(list) {
        if (!Array.isArray(list)) return 0;
        let max = Math.max(list);
        return max;
    }

    function Avg(list) {
        if (!Array.isArray(list)) return 0;
        const avg = (Sum(list) / list.length).toFixed(2);
        return avg;
    }

    function Sum(list) {
        if (!Array.isArray(list)) return 0;
        let sum = 0;
        list.forEach(v => {
            sum += v;
        });
        return sum;
    }

    function SetValueInHTMLById(id, value) {
        const div = document.getElementById(id);
        if (!div) {
            console.warn("SetValueInHTMLById \"id\" is wrong! (" + id + ")");
            return;
        }
        if ('value' in div) {
            div.value = value;
        } else {
            div.innerText = value;
        }
    }

    function showPopup(id) {
        const div = document.getElementById(id);
        if (!div) return console.warn("ไม่พบ ID : " + id);

        div.classList.remove('hidden');
    }

    function hidePopup(id) {
        const div = document.getElementById(id);
        if (!div) return console.warn("ไม่พบ ID : " + id);

        div.classList.add('hidden');
    }
</script>